<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
		<link href="style.css" rel="stylesheet">
	</head>
	<body>
        Login: <input type="text" id="login"><br>
        Password: <input type="text" id="password"><br>
        <button id="submit" onclick="loginButtonHandler()"><font size="5">Login</font></button>
        <button id="submit" onclick="regButtonHandler()"><font size="5">Register</font></button><br>
        <p id="output"></p>
        <script>  
            function loginButtonHandler() {
                var x = document.getElementById("login").value;
                var y = document.getElementById("password").value;
                sendSignInRequest(x, y);
            }

            function regButtonHandler() {
                var x = document.getElementById("login").value;
                var y = document.getElementById("password").value;
                sendSignUpRequest(x, y);
            }

            function sendSignUpRequest(login, password){
                var request = JSON.stringify(
                {
                    type: "sign_up",
                    data: {
                        login:login,
                        password:password
                    }
                } );

                var xhr = new XMLHttpRequest();
                xhr.open('POST', '/api/v1/signup', true);
                xhr.setRequestHeader('Content-Type', 'application/json');

                xhr.onreadystatechange = function(){
                    if (this.readyState != 4)
                        return;

                    if (this.status != 200)
                    {
                        document.getElementById("output").innerHTML = this.status + ':' + this.statusText;
                    }
                    else
                    {
                        document.getElementById("output").innerHTML = this.responseText;
                        // redirect
                        // save cookie
                    }
                }

                xhr.send(request);
            }

            function sendSignInRequest(login, password){
                var request = JSON.stringify(
                {
                    type: "sign_in",
                    data: {
                        login:login,
                        password:password
                    }
                } );

                var xhr = new XMLHttpRequest();
                xhr.open('POST', '/api/v1/signin', true);
                xhr.setRequestHeader('Content-Type', 'application/json');

                xhr.onreadystatechange = function(){
                    if (this.readyState != 4)
                        return;

                    if (this.status != 200)
                    {
                        document.getElementById("output").innerHTML = this.status + ':' + this.statusText;
                    }
                    else
                    {
                        document.getElementById("output").innerHTML = this.responseText;
                        // redirect
                        // save cookie
                    }
                }

                xhr.send(request);
            }
		</script>

	</body>
</html>
